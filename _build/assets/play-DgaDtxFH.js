import{K as ee,p as A,G as H,c as r,z as u,J as _,X as D,r as te,L as E,H as S,M as g,B as c,A as k,$ as re,S as J,V as N}from"./routing-DUaLRc8k.js";import{c as O,a as z,T,r as M,L as ne,g as le,l as ie}from"./Time-CkbcEKMh.js";var G=u("<audio>"),ae=u('<div class="flex flex-col items-center gap-2"><div class="h-4 w-4 animate-spin rounded-full border-2 border-blue-500 border-t-transparent">'),se=u('<button class="cursor-pointer text-lg underline">Pause'),oe=u('<button class="cursor-pointer text-lg underline">Play'),ce=u('<div class="flex h-full flex-row items-center justify-between bg-blue-100 px-4 text-4xl font-bold text-blue-950"><div>'),ue=u('<div class="flex flex-col gap-2"><div class="flex flex-row items-center justify-between"><button class="cursor-pointer text-lg underline">Back 10s</button><button class="cursor-pointer text-lg underline">Back</button><button class="cursor-pointer text-lg underline">Next</button><button class="cursor-pointer text-lg underline">Forward 10s'),de=u('<div class="flex h-full flex-row items-center justify-between bg-green-100 px-4 text-4xl font-bold text-green-950 opacity-60"><div>'),me=u('<div class="flex h-full flex-row items-center justify-between bg-gray-100 px-4 text-4xl font-bold text-gray-950 opacity-60"><div>'),ge=u('<div class="absolute inset-0">'),he=u("<div><div>"),fe=u('<div class="absolute inset-0 bg-white opacity-[var(--opacity)]">');function ye(){let l,o;const i=ee(),[h,s]=A(!0),[f,p]=O([]),[y,B]=A(0),[n,d]=O({playing:!1,itemIndex:0,time:0}),w=()=>f.find(e=>e.id===i.id),x=()=>w()?.items??[],v=()=>x()[n.itemIndex],R=()=>{const e=w();return e?le(e):0},j=()=>{let e=n.time;for(let t=0;t<n.itemIndex;t++)e+=x()[t].duration;return e},K=()=>{if(!n.playing)return;const e=v();e&&(n.time>=e.duration-5&&n.time<e.duration&&(B(1),n.time===e.duration-1?o.play():l.play()),n.time>=e.duration?n.itemIndex===x().length-1?V():F(0):q())},V=()=>{d(e=>({...e,playing:!1,itemIndex:0,time:0}))},X=()=>{const e=Math.max(0,n.itemIndex-1);d(t=>({...t,itemIndex:e,time:0}))},F=e=>{const t=Math.min(n.itemIndex+1,x().length-1);d($=>({...$,itemIndex:t,time:e??0}))},q=()=>{d(e=>({...e,time:e.time+1}))},Q=()=>{const e=Math.max(0,n.time-10);d(t=>({...t,time:e}))},U=()=>{const e=Math.min(n.time+10,v()?.duration??0);d(t=>({...t,time:e}))},W=()=>{d(e=>({...e,playing:!1}))},Y=()=>{d(e=>({...e,playing:!0}))};return H(()=>{p(ie()),s(!1);const e=setInterval(()=>{K()},1e3);return()=>clearInterval(e)}),[(()=>{var e=G(),t=l;return typeof t=="function"?D(t,e):l=e,_(()=>E(e,"src",z("short.mp3"))),e})(),(()=>{var e=G(),t=o;return typeof t=="function"?D(t,e):o=e,_(()=>E(e,"src",z("long.mp3"))),e})(),r(ne,{get children(){return r(S,{get children(){return[r(g,{get when(){return h()},get children(){return ae()}}),r(g,{get when(){return!h()},get children(){var e=ue(),t=e.firstChild,$=t.firstChild,L=$.nextSibling,I=L.nextSibling,Z=I.nextSibling;return $.$$click=Q,L.$$click=X,c(t,r(S,{get children(){return[r(g,{get when(){return n.playing},get children(){var a=se();return a.$$click=W,a}}),r(g,{get when(){return!n.playing},get children(){var a=oe();return a.$$click=Y,a}})]}}),I),I.$$click=()=>F(),Z.$$click=U,c(e,r(C,{class:"opacity-70",color2:"bg-blue-400",get time(){return j()},get duration(){return R()},get children(){var a=ce(),b=a.firstChild;return c(b,()=>w()?.name??""),c(a,r(T,k(()=>M(R()-j()))),null),a}}),null),c(e,r(re,{get each(){return x()},children:(a,b)=>r(S,{get children(){return[r(g,{get when(){return b()===n.itemIndex},get children(){return r(C,{class:"border-3 border-green-300",color2:"bg-green-400",get time(){return n.time},get duration(){return v()?.duration??0},get children(){var m=de(),P=m.firstChild;return c(P,()=>v()?.name??""),c(m,r(T,k(()=>M((v()?.duration??0)-n.time))),null),m}})}}),r(g,{get when(){return b()!==n.itemIndex},get children(){return r(C,{class:"border-3 border-dashed border-gray-300 opacity-50",color2:"bg-gray-400",time:0,get duration(){return a.duration},get children(){var m=me(),P=m.firstChild;return c(P,()=>a.name??""),c(m,r(T,k(()=>M(a.duration))),null),m}})}})]}})}),null),e}})]}})}}),r(xe,{get opacity(){return y()},setOpacity:B})]}function C(l){const o=()=>`${l.time/l.duration*100}%`;return(()=>{var i=he(),h=i.firstChild;return h.style.setProperty("width","var(--width)"),c(i,r(J,{get when(){return l.children},get children(){var s=ge();return c(s,()=>l.children),s}}),null),_(s=>{var f=o(),p="relative h-[64px] w-full "+l.class,y="h-full "+l.color2;return f!==s.e&&((s.e=f)!=null?i.style.setProperty("--width",f):i.style.removeProperty("--width")),p!==s.t&&N(i,s.t=p),y!==s.a&&N(h,s.a=y),s},{e:void 0,t:void 0,a:void 0}),i})()}function xe(l){return H(()=>{const o=setInterval(()=>{l.setOpacity(i=>Math.max(0,i-.04))},16);return()=>clearInterval(o)}),r(J,{get when(){return l.opacity>0},get children(){var o=fe();return _(i=>(i=l.opacity)!=null?o.style.setProperty("--opacity",i):o.style.removeProperty("--opacity")),o}})}te(["click"]);export{ye as default};
