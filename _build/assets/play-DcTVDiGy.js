import{K as W,p as L,G as O,c as r,z as o,X as D,r as Y,H as P,M as g,B as u,A as S,$ as Z,S as z,J as A,V as E}from"./routing-B-zMlmLc.js";import{c as N,l as ee,T as k,r as T,L as te,g as re}from"./Time-CAaGlv3w.js";var ne=o("<audio src=/short.mp3>"),le=o("<audio src=/long.mp3>"),ie=o('<div class="flex flex-col items-center gap-2"><div class="h-4 w-4 animate-spin rounded-full border-2 border-blue-500 border-t-transparent">'),ae=o('<button class="cursor-pointer text-lg underline">Pause'),se=o('<button class="cursor-pointer text-lg underline">Play'),oe=o('<div class="flex h-full flex-row items-center justify-between bg-blue-100 px-4 text-4xl font-bold text-blue-950"><div>'),ce=o('<div class="flex flex-col gap-2"><div class="flex flex-row items-center justify-between"><button class="cursor-pointer text-lg underline">Back 10s</button><button class="cursor-pointer text-lg underline">Back</button><button class="cursor-pointer text-lg underline">Next</button><button class="cursor-pointer text-lg underline">Forward 10s'),ue=o('<div class="flex h-full flex-row items-center justify-between bg-green-100 px-4 text-4xl font-bold text-green-950 opacity-60"><div>'),de=o('<div class="flex h-full flex-row items-center justify-between bg-gray-100 px-4 text-4xl font-bold text-gray-950 opacity-60"><div>'),me=o('<div class="absolute inset-0">'),ge=o("<div><div>"),he=o('<div class="absolute inset-0 bg-white opacity-[var(--opacity)]">');function ve(){let l,c;const i=W(),[h,s]=L(!0),[f,v]=N([]),[y,C]=L(0),[n,d]=N({playing:!1,itemIndex:0,time:0}),_=()=>f.find(e=>e.id===i.id),x=()=>_()?.items??[],p=()=>x()[n.itemIndex],B=()=>{const e=_();return e?re(e):0},R=()=>{let e=n.time;for(let t=0;t<n.itemIndex;t++)e+=x()[t].duration;return e},G=()=>{if(!n.playing)return;const e=p();e&&(n.time>=e.duration-5&&n.time<e.duration&&(C(1),n.time===e.duration-1?c.play():l.play()),n.time>=e.duration?n.itemIndex===x().length-1?H():j(0):K())},H=()=>{d(e=>({...e,playing:!1,itemIndex:0,time:0}))},J=()=>{const e=Math.max(0,n.itemIndex-1);d(t=>({...t,itemIndex:e,time:0}))},j=e=>{const t=Math.min(n.itemIndex+1,x().length-1);d($=>({...$,itemIndex:t,time:e??0}))},K=()=>{d(e=>({...e,time:e.time+1}))},V=()=>{const e=Math.max(0,n.time-10);d(t=>({...t,time:e}))},X=()=>{const e=Math.min(n.time+10,p()?.duration??0);d(t=>({...t,time:e}))},q=()=>{d(e=>({...e,playing:!1}))},Q=()=>{d(e=>({...e,playing:!0}))};return O(()=>{v(ee()),s(!1);const e=setInterval(()=>{G()},1e3);return()=>clearInterval(e)}),[(()=>{var e=ne(),t=l;return typeof t=="function"?D(t,e):l=e,e})(),(()=>{var e=le(),t=c;return typeof t=="function"?D(t,e):c=e,e})(),r(te,{get children(){return r(P,{get children(){return[r(g,{get when(){return h()},get children(){return ie()}}),r(g,{get when(){return!h()},get children(){var e=ce(),t=e.firstChild,$=t.firstChild,F=$.nextSibling,w=F.nextSibling,U=w.nextSibling;return $.$$click=V,F.$$click=J,u(t,r(P,{get children(){return[r(g,{get when(){return n.playing},get children(){var a=ae();return a.$$click=q,a}}),r(g,{get when(){return!n.playing},get children(){var a=se();return a.$$click=Q,a}})]}}),w),w.$$click=()=>j(),U.$$click=X,u(e,r(M,{class:"opacity-70",color2:"bg-blue-400",get time(){return R()},get duration(){return B()},get children(){var a=oe(),b=a.firstChild;return u(b,()=>_()?.name??""),u(a,r(k,S(()=>T(B()-R()))),null),a}}),null),u(e,r(Z,{get each(){return x()},children:(a,b)=>r(P,{get children(){return[r(g,{get when(){return b()===n.itemIndex},get children(){return r(M,{class:"border-3 border-green-300",color2:"bg-green-400",get time(){return n.time},get duration(){return p()?.duration??0},get children(){var m=ue(),I=m.firstChild;return u(I,()=>p()?.name??""),u(m,r(k,S(()=>T((p()?.duration??0)-n.time))),null),m}})}}),r(g,{get when(){return b()!==n.itemIndex},get children(){return r(M,{class:"border-3 border-dashed border-gray-300 opacity-50",color2:"bg-gray-400",time:0,get duration(){return a.duration},get children(){var m=de(),I=m.firstChild;return u(I,()=>a.name??""),u(m,r(k,S(()=>T(a.duration))),null),m}})}})]}})}),null),e}})]}})}}),r(fe,{get opacity(){return y()},setOpacity:C})]}function M(l){const c=()=>`${l.time/l.duration*100}%`;return(()=>{var i=ge(),h=i.firstChild;return h.style.setProperty("width","var(--width)"),u(i,r(z,{get when(){return l.children},get children(){var s=me();return u(s,()=>l.children),s}}),null),A(s=>{var f=c(),v="relative h-[64px] w-full "+l.class,y="h-full "+l.color2;return f!==s.e&&((s.e=f)!=null?i.style.setProperty("--width",f):i.style.removeProperty("--width")),v!==s.t&&E(i,s.t=v),y!==s.a&&E(h,s.a=y),s},{e:void 0,t:void 0,a:void 0}),i})()}function fe(l){return O(()=>{const c=setInterval(()=>{l.setOpacity(i=>Math.max(0,i-.04))},16);return()=>clearInterval(c)}),r(z,{get when(){return l.opacity>0},get children(){var c=he();return A(i=>(i=l.opacity)!=null?c.style.setProperty("--opacity",i):c.style.removeProperty("--opacity")),c}})}Y(["click"]);export{ve as default};
